<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Techies Investments - 3 Phase Tracker</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary: #2563eb; --secondary: #1d4ed8; --success: #10b981;
            --warning: #f59e0b; --danger: #ef4444; --dark: #0f172a;
            --card: #1e293b; --text: #e2e8f0; --text-muted: #94a3b8;
            --border: #334155;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--dark); color: var(--text); line-height: 1.6;
        }
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            padding: 2rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
        }
        .header-content { max-width: 1200px; margin: 0 auto; }
        .badge {
            display: inline-block; padding: 0.25rem 0.75rem;
            background: rgba(255,255,255,0.2); border-radius: 9999px;
            font-size: 0.875rem; font-weight: 600; margin-right: 0.5rem;
        }
        .nav {
            background: var(--card); border-bottom: 1px solid var(--border);
            position: sticky; top: 0; z-index: 90; overflow-x: auto;
        }
        .nav-content {
            max-width: 1200px; margin: 0 auto; display: flex; gap: 0.5rem; padding: 0.5rem;
        }
        .nav-btn {
            padding: 0.75rem 1.5rem; background: transparent; border: none;
            color: var(--text-muted); cursor: pointer; font-weight: 600;
            border-radius: 0.5rem; white-space: nowrap; font-size: 1rem;
        }
        .nav-btn:hover { background: rgba(255,255,255,0.05); color: var(--text); }
        .nav-btn.active { background: var(--primary); color: white; }
        .container { max-width: 1200px; margin: 0 auto; padding: 2rem 1rem; }
        .section { display: none; animation: fadeIn 0.3s ease; }
        .section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .dashboard-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem; margin-bottom: 2rem;
        }
        .phase-card {
            background: var(--card); border: 1px solid var(--border);
            border-radius: 1rem; padding: 1.5rem; cursor: pointer;
            transition: all 0.3s; position: relative;
        }
        .phase-card:hover { transform: translateY(-2px); border-color: var(--primary); }
        .phase-card.active-phase { border-color: var(--success); box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.3); }
        .phase-header { display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem; }
        .phase-title { font-size: 1.25rem; font-weight: 700; margin-bottom: 0.25rem; }
        .phase-subtitle { color: var(--text-muted); font-size: 0.875rem; }
        .phase-status {
            padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.75rem;
            font-weight: 700; text-transform: uppercase;
        }
        .status-active { background: rgba(16, 185, 129, 0.2); color: var(--success); }
        .status-pending { background: rgba(245, 158, 11, 0.2); color: var(--warning); }
        .status-completed { background: rgba(100, 116, 139, 0.2); color: var(--text-muted); }
        .status-surplus { background: rgba(139, 92, 246, 0.2); color: #a78bfa; }
        
        .progress-container { margin: 1.5rem 0; }
        .progress-label { display: flex; justify-content: space-between; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-muted); }
        .progress-bar-bg {
            height: 12px; background: rgba(255,255,255,0.1);
            border-radius: 9999px; overflow: hidden;
        }
        .progress-bar-fill {
            height: 100%; background: linear-gradient(90deg, var(--success), #34d399);
            border-radius: 9999px; transition: width 0.5s ease;
        }
        .progress-bar-fill.excess {
            background: linear-gradient(90deg, #8b5cf6, #a78bfa);
        }
        
        .card {
            background: var(--card); border: 1px solid var(--border);
            border-radius: 1rem; padding: 2rem; margin-bottom: 1.5rem;
        }
        .card-title { font-size: 1.25rem; margin-bottom: 1.5rem; color: var(--text); }
        .grid-2 { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 2rem; }
        
        table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
        th {
            background: rgba(255,255,255,0.05); padding: 1rem; text-align: left;
            font-weight: 600; color: var(--text-muted); text-transform: uppercase;
            font-size: 0.75rem; letter-spacing: 0.05em; border-bottom: 1px solid var(--border);
        }
        td { padding: 1rem; border-bottom: 1px solid var(--border); color: var(--text); }
        tr:hover td { background: rgba(255,255,255,0.02); }
        .amount { font-family: 'Courier New', monospace; font-weight: 600; }
        .highlight-green { color: var(--success); }
        .highlight-yellow { color: var(--warning); }
        .highlight-blue { color: #60a5fa; }
        .highlight-purple { color: #a78bfa; }
        
        .member-grid { display: grid; gap: 1rem; }
        .member-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 1rem; background: rgba(255,255,255,0.03);
            border: 1px solid var(--border); border-radius: 0.75rem;
        }
        .badge-small {
            padding: 0.25rem 0.75rem; border-radius: 9999px;
            font-size: 0.75rem; font-weight: 600;
        }
        .alert {
            padding: 1.2rem; border-radius: 0.75rem; margin-bottom: 1.5rem;
            border-left: 4px solid;
        }
        .alert-success {
            background: rgba(16, 185, 129, 0.1); border-color: var(--success); color: #6ee7b7;
        }
        .alert-warning {
            background: rgba(245, 158, 11, 0.1); border-color: var(--warning); color: #fbbf24;
        }
        .alert-info {
            background: rgba(37, 99, 235, 0.1); border-color: var(--primary); color: #93c5fd;
        }
        .alert-excess {
            background: rgba(139, 92, 246, 0.1); border-color: #8b5cf6; color: #a78bfa;
        }
        
        .summary-cards {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem; margin-bottom: 2rem;
        }
        .summary-card {
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.1), rgba(29, 78, 216, 0.2));
            border: 1px solid rgba(37, 99, 235, 0.3);
            padding: 1.5rem; border-radius: 1rem; text-align: center;
        }
        .summary-number { font-size: 2.5rem; font-weight: 800; color: white; margin-bottom: 0.5rem; }
        .summary-label { color: var(--text-muted); font-size: 0.875rem; text-transform: uppercase; }
        
        .payment-log { margin-top: 2rem; }
        .log-entry {
            padding: 0.75rem; background: rgba(255,255,255,0.03);
            border-left: 3px solid var(--success);
            margin-bottom: 0.5rem; border-radius: 0 0.5rem 0.5rem 0;
            display: flex; justify-content: space-between; align-items: center;
        }
        .log-date { font-size: 0.75rem; color: var(--text-muted); }
        
        .surplus-box {
            background: rgba(139, 92, 246, 0.1); border: 1px solid rgba(139, 92, 246, 0.3);
            padding: 1rem; border-radius: 0.75rem; margin-top: 1rem;
            text-align: center;
        }
        
        @media (max-width: 768px) {
            .grid-2 { grid-template-columns: 1fr; }
            .dashboard-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<div class="header">
    <div class="header-content">
        <h1>TECHIES INVESTMENTS</h1>
        <div>
            <span class="badge">Y10 • Y12 • Y16 Bars</span>
            <span class="badge">2026-2028</span>
        </div>
        <p style="margin-top: 0.5rem; opacity: 0.9;">3-Phase Program Tracker (31 Months)</p>
    </div>
</div>

<nav class="nav">
    <div class="nav-content">
        <button class="nav-btn active" onclick="showSection('dashboard')">Dashboard</button>
        <button class="nav-btn" onclick="showSection('phase1')">Phase 1 (Y10)</button>
        <button class="nav-btn" onclick="showSection('phase2')">Phase 2 (Y12)</button>
        <button class="nav-btn" onclick="showSection('phase3')">Phase 3 (Y16)</button>
        <button class="nav-btn" onclick="showSection('members')">Members</button>
    </div>
</nav>

<div class="container">
    
    <!-- DASHBOARD -->
    <div id="dashboard" class="section active">
        <h2 style="margin-bottom: 0.5rem;">Program Overview</h2>
        <p style="color: var(--text-muted); margin-bottom: 2rem;">Master Timeline: Jan 2026 - Jul 2028</p>

        <div class="summary-cards">
            <div class="summary-card">
                <div class="summary-number" style="color: #60a5fa;">361</div>
                <div class="summary-label">Total Bars</div>
            </div>
            <div class="summary-card">
                <div class="summary-number" style="color: #34d399;" id="dashboard-total-raised">MK 0</div>
                <div class="summary-label">Total Raised (All Phases)</div>
            </div>
            <div class="summary-card">
                <div class="summary-number" style="color: #fbbf24;">6</div>
                <div class="summary-label">Active Members</div>
            </div>
            <div class="summary-card">
                <div class="summary-number" style="color: #f472b6;" id="current-phase-display">1</div>
                <div class="summary-label">Current Phase</div>
            </div>
        </div>

        <div id="phase-cards-container">
            <!-- Generated by JavaScript -->
        </div>
    </div>

    <!-- PHASE 1 -->
    <div id="phase1" class="section">
        <h2 style="margin-bottom: 0.5rem;">Phase 1: Y10 Bars Acquisition</h2>
        <div style="margin-bottom: 2rem;">
            <span class="badge status-active">ACTIVE</span>
            <span class="badge">Jan 2026</span>
            <span class="badge">Goal: MK 520,000</span>
        </div>

        <div id="p1-status-alert">
            <!-- Dynamic status alert -->
        </div>

        <div class="grid-2">
            <div class="card">
                <h3 class="card-title">Funding Status (Auto-Calculated)</h3>
                <div style="text-align: center; margin: 2rem 0;">
                    <div style="font-size: 3rem; font-weight: 800; color: var(--success);" id="p1-total-raised">MK 0</div>
                    <div style="color: var(--text-muted); margin-top: 0.5rem;">Total Raised</div>
                </div>
                
                <div class="progress-container">
                    <div class="progress-label">
                        <span id="p1-progress-text">Progress to MK 520,000 Goal</span>
                        <span id="p1-percent">0%</span>
                    </div>
                    <div class="progress-bar-bg">
                        <div class="progress-bar-fill" id="p1-bar" style="width: 0%"></div>
                    </div>
                </div>

                <div id="p1-surplus-box" class="surplus-box hidden">
                    <div style="font-size: 1.5rem; font-weight: 700; color: #a78bfa;" id="p1-surplus-amount">MK 0</div>
                    <div style="font-size: 0.875rem; color: var(--text-muted);">Surplus (rolls over to Phase 2)</div>
                </div>

                <div style="margin-top: 1.5rem;">
                    <table>
                        <tr><td>Target Goal</td><td class="amount">MK 520,000</td></tr>
                        <tr><td>Total Raised</td><td class="amount highlight-green" id="p1-table-raised">MK 0</td></tr>
                        <tr><td>Remaining Needed</td><td class="amount highlight-yellow" id="p1-table-remaining">MK 520,000</td></tr>
                        <tr style="background: rgba(255,255,255,0.03);"><td>Phase Cost</td><td class="amount">MK 3,120,000</td></tr>
                    </table>
                </div>
            </div>

            <div class="card">
                <h3 class="card-title">Member Contributions</h3>
                <p style="color: var(--text-muted); margin-bottom: 1.5rem; font-size: 0.9rem;">
                    M'mene zinthu zikuyendela.
                </p>
                
                <div class="member-grid" id="p1-members-list">
                    <!-- Generated by JavaScript -->
                </div>

                <div class="payment-log">
                    <h4 style="margin-bottom: 1rem; color: var(--text-muted); font-size: 0.9rem; text-transform: uppercase;">Recent Payments</h4>
                    <div id="p1-payment-log">
                        <!-- Generated from CONFIG -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- PHASE 2 -->
    <div id="phase2" class="section">
        <h2 style="margin-bottom: 0.5rem;">Phase 2: Y12 Bars Program</h2>
        <div style="margin-bottom: 2rem;">
            <span class="badge status-pending">Feb - Aug 2026</span>
            <span class="badge">7 Months</span>
            <span class="badge">Monthly: MK 444,000</span>
        </div>

        <div class="alert alert-info">
            <strong>Note:</strong> Any surplus from Phase 1 will be deducted from the first month(s) of Phase 2.
        </div>

        <div class="grid-2">
            <div class="card">
                <h3 class="card-title">Program Structure</h3>
                <table>
                    <tr><td>Material</td><td><strong>Y12 Bars</strong></td></tr>
                    <tr><td>Unit Cost</td><td class="amount">MK 37,000</td></tr>
                    <tr><td>Monthly Target</td><td class="amount highlight-blue">12 bars (MK 444,000)</td></tr>
                    <tr><td>Duration</td><td>7 months (Feb - Aug 2026)</td></tr>
                    <tr><td>Total Bars</td><td class="amount highlight-green">81 bars</td></tr>
                    <tr><td>Total Investment</td><td class="amount" style="color: var(--success);">MK 2,997,000</td></tr>
                </table>
            </div>

            <div class="card">
                <h3 class="card-title">Monthly Schedule</h3>
                <table>
                    <thead><tr><th>Month</th><th>Bars</th><th>Cost</th><th>Balance</th></tr></thead>
                    <tbody>
                        <tr><td>Feb 2026</td><td>12</td><td class="amount">MK 444,000</td><td class="highlight-green">MK 36,000</td></tr>
                        <tr><td>Mar 2026</td><td>12</td><td class="amount">MK 444,000</td><td class="highlight-green">MK 36,000</td></tr>
                        <tr><td>Apr 2026</td><td>12</td><td class="amount">MK 444,000</td><td class="highlight-green">MK 36,000</td></tr>
                        <tr><td>May 2026</td><td>12</td><td class="amount">MK 444,000</td><td class="highlight-green">MK 36,000</td></tr>
                        <tr><td>Jun 2026</td><td>12</td><td class="amount">MK 444,000</td><td class="highlight-green">MK 36,000</td></tr>
                        <tr><td>Jul 2026</td><td>12</td><td class="amount">MK 444,000</td><td class="highlight-green">MK 36,000</td></tr>
                        <tr style="background: rgba(255,255,255,0.03);"><td>Aug 2026</td><td>9</td><td class="amount">MK 333,000</td><td class="highlight-yellow">MK 147,000</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- PHASE 3 -->
    <div id="phase3" class="section">
        <h2 style="margin-bottom: 0.5rem;">Phase 3: Y16 Bars Program</h2>
        <div style="margin-bottom: 2rem;">
            <span class="badge" style="background: rgba(139, 92, 246, 0.2); color: #a78bfa;">Sep 2026 - Jul 2028</span>
            <span class="badge">23 Months</span>
        </div>

        <div class="grid-2">
            <div class="card">
                <h3 class="card-title">Long-Term Overview</h3>
                <table>
                    <tr><td>Material</td><td><strong>Y16 Bars</strong></td></tr>
                    <tr><td>Unit Cost</td><td class="amount">MK 66,000</td></tr>
                    <tr><td>Monthly Power</td><td class="amount highlight-blue">7 bars (MK 462,000)</td></tr>
                    <tr><td>Regular Period</td><td>Sep 2026 - Jun 2028 (22 mos)</td></tr>
                    <tr><td>Final Month</td><td class="highlight-yellow">Jul 2028 (6 bars)</td></tr>
                    <tr style="background: rgba(255,255,255,0.03);"><td>Total Investment</td><td class="amount highlight-green">MK 10,560,000</td></tr>
                </table>
            </div>

            <div class="card">
                <h3 class="card-title">Acquisition Summary</h3>
                <div style="padding: 1.5rem; background: rgba(255,255,255,0.03); border-radius: 0.75rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 1rem;">
                        <span>Regular Purchases (22 months × 7)</span>
                        <span class="amount highlight-blue">154 bars</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 1rem;">
                        <span>Final Completion (Jul 2028)</span>
                        <span class="amount highlight-yellow">6 bars</span>
                    </div>
                    <div style="border-top: 1px solid var(--border); padding-top: 1rem; display: flex; justify-content: space-between; font-weight: 700;">
                        <span>Total Bars</span>
                        <span class="amount highlight-green">160 bars</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MEMBERS -->
    <div id="members" class="section">
        <h2 style="margin-bottom: 0.5rem;">Member Contributions</h2>
        <p style="color: var(--text-muted); margin-bottom: 2rem;">Cumulative totals across all phases (Jan 2026 - Jul 2028)</p>

        <div class="card">
            <div style="overflow-x: auto;">
                <table>
                    <thead>
                        <tr>
                            <th>Member</th>
                            <th>Amount Paid</th>
                            <th>% of Total</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="members-table-body">
                        <!-- Generated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <div class="card">
            <h3 class="card-title">Total Collections</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem; text-align: center;">
                <div>
                    <div style="font-size: 2rem; font-weight: 800; color: var(--success);" id="members-total-raised">MK 0</div>
                    <div style="color: var(--text-muted); margin-top: 0.5rem;">Total Collected</div>
                </div>
                <div>
                    <div style="font-size: 2rem; font-weight: 800; color: #60a5fa;" id="members-total-target">MK 520,000</div>
                    <div style="color: var(--text-muted); margin-top: 0.5rem;">Phase 1 Target</div>
                </div>
                <div>
                    <div style="font-size: 2rem; font-weight: 800; color: var(--warning);" id="members-total-remaining">MK 520,000</div>
                    <div style="color: var(--text-muted); margin-top: 0.5rem;">Remaining</div>
                </div>
            </div>
        </div>
    </div>

</div>

<script>
/* ============================================
   CONFIGURATION - EDIT THIS SECTION ONLY
   ============================================ */

const CONFIG = {
    // MEMBER LIST (6 members)
    members: ['Patrick', 'Walusungu', 'Allan', 'Sudi', 'Edmond', 'Sam'],
    
    // PHASE 1 CONFIGURATION
    phase1: {
        goal: 520000,           // Amount to raise in Phase 1
        unitCost: 26000,        // Cost per Y10 bar
        totalBars: 120,         // Total bars to buy
        
        /* 
           CONTRIBUTIONS - KEEP ADDING TO THESE NUMBERS
           When someone pays, add the amount to their current total
           Example: If Sudi pays 80,000 then later 80,000 again:
           Change: Sudi: 80000 ? Sudi: 160000
        */
        contributions: {
            Patrick: 100000,     // Cumulative amount paid
            Walusungu: 100000,   // Cumulative amount paid  
            Allan: 80000,            // EDIT: Add amounts here as they pay
            Sudi: 80000,             // EDIT: Example: Change to 160000 after two payments of 80k
            Edmond: 100000,           // EDIT: Add amounts here
            Sam: 100000               // EDIT: Add amounts here
        },
        
        // PAYMENT LOG - Track individual transactions (optional, for display)
        paymentLog: [
            { member: 'Patrick', amount: 100000, date: 'Jan 2026', note: 'Initial payment' },
            { member: 'Walusungu', amount: 100000, date: 'Jan 2026', note: 'Initial payment' },
            // Add new entries below as payments come in:
             { member: 'Allan', amount: 80000, date: 'Jan 2026', note: 'Initial payment' },
             { member: 'Edmond', amount: 100000, date: 'Jan 2026', note: 'Initial payment' },
            { member: 'Samy', amount: 100000, date: 'Jan 2026', note: 'Initial payment' },
            { member: 'Sudi', amount: 80000, date: 'Jan 2026', note: 'Initial payment' },
            // { member: 'Allan', amount: 80000, date: 'Jan 2026', note: '' },
        ]
    },
    
    // PHASE 2 & 3 CONSTANTS
    phase2: {
        monthlyTarget: 444000,
        totalBars: 81,
        months: 7
    },
    phase3: {
        monthlyTarget: 462000,
        totalBars: 160,
        months: 23
    }
};

/* ============================================
   DO NOT EDIT BELOW - AUTO CALCULATIONS
   ============================================ */

function formatMoney(amount) {
    return 'MK ' + amount.toLocaleString();
}

function calculatePhase1() {
    let totalRaised = 0;
    const contributions = CONFIG.phase1.contributions;
    
    for (let member of CONFIG.members) {
        totalRaised += (contributions[member] || 0);
    }
    
    const goal = CONFIG.phase1.goal;
    const remaining = goal - totalRaised;
    const percent = Math.min(100, Math.max(0, (totalRaised / goal) * 100));
    const surplus = totalRaised > goal ? totalRaised - goal : 0;
    const isComplete = totalRaised >= goal;
    
    return {
        raised: totalRaised,
        remaining: remaining > 0 ? remaining : 0,
        surplus: surplus,
        percent: percent.toFixed(1),
        isComplete: isComplete,
        isExcess: surplus > 0
    };
}

function initDashboard() {
    const calc = calculatePhase1();
    const p1 = CONFIG.phase1;
    
    // Update total raised
    document.getElementById('dashboard-total-raised').textContent = formatMoney(calc.raised);
    
    // Determine current phase
    let currentPhase = 1;
    let phaseStatus = 'Active';
    let statusClass = 'status-active';
    
    if (calc.isComplete) {
        currentPhase = 2; // Move to phase 2
        phaseStatus = 'Phase 1 Complete';
        statusClass = 'status-completed';
    }
    
    document.getElementById('current-phase-display').textContent = currentPhase;
    
    // Cards HTML
    let cardsHtml = `
        <div class="phase-card ${calc.isComplete ? '' : 'active-phase'}" onclick="showSection('phase1')">
            <div class="phase-header">
                <div>
                    <div class="phase-title">Phase 1: Y10 Bars</div>
                    <div class="phase-subtitle">Jan 2026 • ${p1.totalBars} Bars</div>
                </div>
                <span class="phase-status ${calc.isExcess ? 'status-surplus' : (calc.isComplete ? 'status-completed' : 'status-active')}">
                    ${calc.isExcess ? 'EXCESS' : (calc.isComplete ? 'COMPLETE' : 'ACTIVE')}
                </span>
            </div>
            <div class="progress-container">
                <div class="progress-label">
                    <span>${calc.isExcess ? 'Excess Funds:' : 'Progress:'} ${formatMoney(calc.raised)}</span>
                    <span>${calc.percent}%</span>
                </div>
                <div class="progress-bar-bg">
                    <div class="progress-bar-fill ${calc.isExcess ? 'excess' : ''}" style="width: ${calc.percent}%"></div>
                </div>
            </div>
            <div style="margin-top: 1rem; font-size: 0.9rem; 
                        color: ${calc.isExcess ? '#a78bfa' : (calc.isComplete ? 'var(--success)' : 'var(--warning)')}; 
                        font-weight: 600;">
                ${calc.isExcess ? `SURPLUS: ${formatMoney(calc.surplus)} for Phase 2` : 
                  (calc.isComplete ? 'GOAL REACHED! Funds secured.' : `${formatMoney(calc.remaining)} remaining`)}
            </div>
        </div>

        <div class="phase-card ${calc.isComplete ? 'active-phase' : ''}" onclick="showSection('phase2')">
            <div class="phase-header">
                <div>
                    <div class="phase-title">Phase 2: Y12 Bars</div>
                    <div class="phase-subtitle">Feb-Aug 2026 • 7 Months</div>
                </div>
                <span class="phase-status ${calc.isComplete ? 'status-active' : 'status-pending'}">
                    ${calc.isComplete ? 'READY' : 'UPCOMING'}
                </span>
            </div>
            <div style="margin-top: 1rem; color: var(--text-muted); font-size: 0.9rem;">
                ${calc.isComplete ? 
                    `<span style="color: var(--success);">? Phase 1 funded. Ready to start Feb 2026.</span>` : 
                    'Waiting for Phase 1 completion'}
            </div>
            <div style="margin-top: 0.5rem; font-size: 0.85rem; color: var(--text-muted);">
                Monthly: ${formatMoney(CONFIG.phase2.monthlyTarget)} • 81 bars total
            </div>
        </div>

        <div class="phase-card" onclick="showSection('phase3')">
            <div class="phase-header">
                <div>
                    <div class="phase-title">Phase 3: Y16 Bars</div>
                    <div class="phase-subtitle">Sep 2026 - Jul 2028</div>
                </div>
                <span class="phase-status status-pending">FUTURE</span>
            </div>
            <div style="margin-top: 1rem; color: var(--text-muted); font-size: 0.9rem;">
                23 months • 160 bars • Ends July 2028
            </div>
            <div style="margin-top: 0.5rem; font-size: 0.85rem; color: var(--text-muted);">
                Long-term accumulation phase
            </div>
        </div>
    `;
    
    document.getElementById('phase-cards-container').innerHTML = cardsHtml;
}

function initPhase1() {
    const calc = calculatePhase1();
    const p1 = CONFIG.phase1;
    
    // Status alert
    const alertBox = document.getElementById('p1-status-alert');
    if (calc.isExcess) {
        alertBox.className = 'alert alert-excess';
        alertBox.innerHTML = `<strong>PHASE 1 EXCEEDS TARGET!</strong> We have raised ${formatMoney(calc.raised)}. 
        MK ${calc.surplus.toLocaleString()} will roll over as credit for Phase 2.`;
    } else if (calc.isComplete) {
        alertBox.className = 'alert alert-success';
        alertBox.innerHTML = `<strong>GOAL REACHED!</strong> Phase 1 fully funded. Ready to purchase 120 Y10 bars.`;
    } else {
        alertBox.className = 'alert alert-warning';
        alertBox.innerHTML = `<strong>IN PROGRESS:</strong> We need ${formatMoney(calc.remaining)} more by Jan 31, 2026.`;
    }
    
    // Update numbers
    document.getElementById('p1-total-raised').textContent = formatMoney(calc.raised);
    document.getElementById('p1-percent').textContent = calc.percent + '%';
    document.getElementById('p1-bar').style.width = calc.percent + '%';
    document.getElementById('p1-table-raised').textContent = formatMoney(calc.raised);
    document.getElementById('p1-table-remaining').textContent = formatMoney(calc.remaining);
    
    // Surplus box
    const surplusBox = document.getElementById('p1-surplus-box');
    if (calc.surplus > 0) {
        surplusBox.classList.remove('hidden');
        document.getElementById('p1-surplus-amount').textContent = formatMoney(calc.surplus);
        document.getElementById('p1-progress-text').textContent = 'Goal Exceeded!';
    } else {
        surplusBox.classList.add('hidden');
        document.getElementById('p1-progress-text').textContent = 'Progress to MK 520,000 Goal';
    }
    
    // Members list
    let membersHtml = '';
    CONFIG.members.forEach(member => {
        const amount = p1.contributions[member] || 0;
        const percent = (amount / p1.goal * 100).toFixed(1);
        
        membersHtml += `
            <div class="member-item">
                <div>
                    <div style="font-weight: 600; font-size: 1.1rem;">${member}</div>
                    <div style="font-size: 0.875rem; color: ${amount > 0 ? 'var(--success)' : 'var(--text-muted)'};">
                        ${amount > 0 ? formatMoney(amount) + ' (' + percent + '% of goal)' : 'No contribution yet'}
                    </div>
                </div>
                <span class="badge-small ${amount > 0 ? 'status-active' : 'status-pending'}">
                    ${amount > 0 ? 'Paid' : 'Pending'}
                </span>
            </div>
        `;
    });
    document.getElementById('p1-members-list').innerHTML = membersHtml;
    
    // Payment log
    const logContainer = document.getElementById('p1-payment-log');
    if (p1.paymentLog && p1.paymentLog.length > 0) {
        let logHtml = '';
        // Sort by most recent first
        [...p1.paymentLog].reverse().forEach(entry => {
            logHtml += `
                <div class="log-entry">
                    <div>
                        <strong>${entry.member}</strong> paid ${formatMoney(entry.amount)}
                        ${entry.note ? `<span style="color: var(--text-muted); font-size: 0.9rem;"> - ${entry.note}</span>` : ''}
                    </div>
                    <div class="log-date">${entry.date}</div>
                </div>
            `;
        });
        logContainer.innerHTML = logHtml;
    } else {
        logContainer.innerHTML = '<div style="color: var(--text-muted); font-style: italic;">No payments recorded yet</div>';
    }
}

function initMembers() {
    const calc = calculatePhase1();
    const p1 = CONFIG.phase1;
    
    let tbody = '';
    let grandTotal = 0;
    
    CONFIG.members.forEach(member => {
        const amount = p1.contributions[member] || 0;
        grandTotal += amount;
        const percent = calc.raised > 0 ? ((amount / calc.raised) * 100).toFixed(1) : '0';
        
        tbody += `
            <tr>
                <td><strong>${member}</strong></td>
                <td class="amount highlight-green">${amount > 0 ? formatMoney(amount) : '-'}</td>
                <td>${calc.raised > 0 ? percent + '%' : '-'}</td>
                <td>
                    <span class="badge-small ${amount > 0 ? 'status-active' : 'status-pending'}">
                        ${amount > 0 ? 'Active' : 'Pending'}
                    </span>
                </td>
            </tr>
        `;
    });
    
    document.getElementById('members-table-body').innerHTML = tbody;
    
    // Summary
    document.getElementById('members-total-raised').textContent = formatMoney(grandTotal);
    document.getElementById('members-total-remaining').textContent = 
        calc.remaining > 0 ? formatMoney(calc.remaining) : 'MK 0 (COMPLETE)';
    document.getElementById('members-total-remaining').style.color = 
        calc.remaining > 0 ? 'var(--warning)' : 'var(--success)';
}

function showSection(sectionId) {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.getElementById(sectionId).classList.add('active');
    
    document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    
    if(sectionId === 'dashboard') initDashboard();
    if(sectionId === 'phase1') initPhase1();
    if(sectionId === 'members') initMembers();
}

document.addEventListener('DOMContentLoaded', () => {
    initDashboard();
    initPhase1();
    initMembers();
});
</script>

</body>
</html>
